data1 = "MjAyNS0wMy0yMFQyMToxODo0MZfYKRjT5HKj3LMrkIqoMhWSfXVKV+b/0lI9G9Cc2nuucdMHEAGTjoJA6BOONVzQZJplgE2PZ+GJY680WmSYaSe1YRGfeuhYr7U4ry3FQvcvNFQrwrnpdNYC6HrESQ1DnG6zPGwRbQTrhU5B511W3hUlCStziyHHy7R57wUC+kf2H/zVoPu1H9iuSFA3+XMDW0FewwOJ08v3BAI1ne86gj8tTRvP6st64oUwkKDpjGq2gFlKr7jRT3DKzyNPPpndjDEV3vZbU0npzSn6rOjvmhi/rTAQbNs2olbqWKvbR7gU6hUeaqcAz+fcsPor42t82UROTLEGy1IBz76zDuiOvyR+5DV9ePgcXklN8t+/O60oQ4/8cFQnPMN/UrRmPFfFDJqcBgNIVJXAHnuwBbkA3XUZihWIXlLq1/AW5lpAvDlEeHf79yWLiVi9IBrrTFxRMs1nPQdhcQ6L+SFBMExtn2W1YdoKKWwMIKvo+2fgIVDLPXn5GxfEN+ddT924xc36YrL9QKn+CiJr/gxVO3i9NBekielHcwYPLbmAnujLsw95fkybYSoSILz3WLJr/JbkE322RaWT2hMfDfugF5Wyk+EoRsLr5MrQthHEIDVll0uz1bG88PMjCaTeNmcHZGf15RzivPayYG+PilhzvhYIiwCDyuhdVY237S4j+m6UbernKAMhGHWPozicORXz2s/aPnXrv5C2Glykke3NLhtxOeM7PFxol0VS6K0Mdv+ARfX7tI3dT3kQ1hEQto5pMudeUGzcVrkNRH5ubLkFXrrqVsN7u9EoWwyRcDbNxGZq4yUIYmcZmO4Xzqc+X96Ky3pk02SSaJyUdjc3x9uvmgDPHLhCv3MTopIdiHKa5klua8hFuCIs669LcjyNtOp1m3B/cKNwucfQjnyU4hFOrzvTPZg2ohB6MvrV68UA8HSlzHROJ7/mHDxs/ynSohbM62mP/c0DDyLWAXiKSsceYCre7/lacFaQTnMMFLnnYF3oI0IGq6pviLPfnFt4mCvFBbE7pFajgIg6qV46GC2p9IlLSTdHL8ls7vAyP6NGH63QrCobf3lIEhYvnVBO5Q6o02SGNdy6fBYw473gGzIJ1aReEWb862OenfiBhFlZLPOu7e5uki1e4RHFK/ibYswTQpKtqtKpFiW2TGnW8rJQHCS/rg7loWcF27GbScbVRjtL6E/T3GiBpAqxdHQ0/VvUhkODMsOmBizfeRtNSJYiejLVDKvW+m4pLJ27xQVA3WWHhVWDIX+bw6JUEgwUZe5eLcFCQigwVPsnv/+h/pf4FYERlDJzNFMT97NPm/qkeliKSwg6cmnsEi2cLsE3oU+kpklc+qy6B2Aijicx8MfEuXDYkn4kX4YLp/8mxq33eZ5130afZmMFip6FeYR4LBt15g7cZ4F4fIl1H6Gade7MTUN3psM6U93DxlJFkVlhU3W+zeEEfJGeeffs+I/d5jcbzqJMybKS8nUpz1v24tuq0qpUzscL+8PvLg4UnjbeihQOy2vm6c/vaKmjp888Xj/1OCPvwesLPJLT3e2Ep6kNIli3rsPidShWITi/qx95Qg3W2FUCcRui9BbfC53RSutUbm9fWk3R4tNTpVs2WoqU53Gkj4JwX+hOQoSHFDjf5fzYdLtVyklL1KyDOtMIpfn8NjFphUvlOlw="
data2 = "MjAyNS0wMy0yMVQxMTo0MTo0MIrIMs6xaOo7wyeytrspbqObPT+Urr1R496BBbyNEJfBcOw2GW4yFgPRgrw8RH+AsqGr6hrltCbq7Lk4g2BHjAyew7VE7YcvAHwN2xF2hIZfnMJwL8ZHL6n86iH/tiCy1Qax7tn+P7BH+IX2FFk8zs+wnqzeV4jfP8HZun6oZ4haRdfcca17M3u9YezU0JpUrxo3n17Ab4a/Jja7CpNGV9An0xyW6P23qI7JqCgno5wgFoOoR9fNiiN5SyAPhyWVmFAz1oEsUfKx5+S7PsjWDzoyWQWLXEcfaPt800j9KyCGe2+99EmVevnceuukb1B2OxlBX/fnOWGz96cqkmSEGADiygH2JP2FN4/fIXPKrH0SlPfZBwWn+p/oF4RITEFDd5tDk/x+23HxB5QZd0EQRWW54Ihmg035fUd8PGcFSqGZt/WfvHNgHyoDbAJmSVAggJFC3bvCokZ5EDJ93dOxq8eAsU0CcmfVzosFQMk330p/HovSXbln5BCSPAn5+TZLJc1DP0yFHWffufegmmG9qH40obPBJSGaL/vdC16znGd8kl8gtu9NLmYBy2+/PNnzrTxnCoqTQMDMiZrPjQcTV7MrqGwbRtSzyxQoSAKEEIrpQhwt6DDrzkp1Qd7J0+ePh/lxhiR/bDBG0Qrij1Mw8hmIagF5VbMJvEi/Y8nPlwT+jUzkraVwLpmpQUOwcgVqfuAYyZOXqNZhDULN1fV7rR/lqZWL3BGANIrN+6jZlfKSzFfZ3eKYLc7fvNS00J6IEFDhXk0JMwkEWGQdtnWhs4bmPDHQwjgmvoLZIL7/FDmgm7RmENunahQen9SnE/8WoZsbcfPIB8VP0QLae/MLidh1MCFYV3LVapdMvvCxG6O5aOdOpdw8TKrMWGaLC/22ddOjhY49Sihvkmrnzmn2N6GZ3NTUSmLOMd30bU8obSckNshkWFJSw6rKCslvrPo0WCV6A/GGkLnG2wDXbE656M7p1NqfzRyFvKOhO2QBE+DBkOJ6r7i6NpnEKLDWVDah6lz68VKFoKFwEdVQ6iwvveaSJnGmhKLDeteO8lEW8p+BLg8kQaBft8ty/eBXlX8uA8dxfU6k9SFUFtfbKA6bRnYs2sxLsSBGc9aO5NcqMs8SE/vw3qgNH2uqZQzJ0Xa+ipB0f7utWCLMVkEk39+Y44cvhqX25i5qAP5lJjqFEDoHySRuXNc1bHr6SIJVJSxV1d5GVRl24t6nFmM4idZlG651ALhUcAvYGvuXQ0RQfxYGER8AfcJUvJzoflx2aNb8+naoI5ZLfDiV2f6nUV0TNLSu+87d4SKKvax15pQBy0oPQCzoUVkLhyrMMFMuDMxttnSXuhpMq0DfCL+T8VABgNULE1ttIYErbgp8PpUGjOur3Y4WysWdoEhHaj00FXGWwIq2lGRvIrSMp1+XH8x/LWfAIm8lLha7WJ8knqYDe4PHItKTolTyaBY3CjWYO6aYi2UWYmnAFPs5OH+hlcDeqWxKIxnQYIet7vStoS30TXwSBjec2tNhlKPHFXnuzEVWoM75AqNqZA8IgIkZ9iV5uDbo+8TdKeuFwAXlHPUCLAfNx9gz20+uVSh5U8f6bAREc3ec7m2H2JfqT+cJet7OxtbOaCDebTUjKJYsdjRtqCiBU6aZanJiBvbcPuK22pSly+mmRkpA6Vn42FlvjpF/lw8="
import base64
import cv2
import numpy as np
import xml.etree.ElementTree as ET
from skimage.metrics import structural_similarity as ssim

def extract_fingerprint_image(data):
    # Decode Base64
    wsq_data = base64.b64decode(data)
    
    # Save as WSQ file (temporary)
    with open("temp_fp.wsq", "wb") as f:
        f.write(wsq_data)
    
    # Convert WSQ to PNG using `mindtct` (from NBIS) or OpenCV if already in raw format
    # If WSQ, you need NBIS tools (Linux/WSL required)
    # Alternative: If it's raw image data, use OpenCV directly
    try:
        img = cv2.imread("temp_fp.wsq", cv2.IMREAD_GRAYSCALE)
        if img is None:
            raise ValueError("Failed to decode fingerprint image")
        return img
    except Exception as e:
        raise ValueError(f"Error processing fingerprint: {str(e)}")
    

def compare_fingerprints(img1, img2):
    """Compare two fingerprint images using SSIM"""
    # Resize to same dimensions (if needed)
    if img1.shape != img2.shape:
        img2 = cv2.resize(img2, (img1.shape[1], img1.shape[0]))
    
    # Calculate SSIM (0 to 1, where 1 = identical)
    score, _ = ssim(img1, img2, full=True)
    return score


try:
    img1 = extract_fingerprint_image(data1)
    img2 = extract_fingerprint_image(data2)
    
    similarity = compare_fingerprints(img1, img2)
    print(f"Fingerprint similarity score: {similarity * 100:.2f}%")
    
    # Display images (optional)
    cv2.imshow("Fingerprint 1", img1)
    cv2.imshow("Fingerprint 2", img2)
    cv2.waitKey(0)
    cv2.destroyAllWindows()
except Exception as e:
    print(f"Error: {str(e)}")